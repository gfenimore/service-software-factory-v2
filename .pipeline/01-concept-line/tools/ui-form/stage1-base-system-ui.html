<!DOCTYPE html>
<html>
<head>
    <title>Stage 1: Base System Configuration</title>
    <meta charset="utf-8">
    <meta name="viewport" content="width=device-width, initial-scale=1">
    <style>
        body { 
            font-family: 'Segoe UI', Tahoma, Geneva, Verdana, sans-serif; 
            margin: 0; 
            background: #f5f5f5; 
            padding: 20px;
        }
        .container { 
            max-width: 1000px; 
            margin: 0 auto; 
            background: white;
            border-radius: 8px;
            padding: 30px;
            box-shadow: 0 2px 4px rgba(0,0,0,0.1);
        }
        h1 { color: #2c3e50; margin-bottom: 30px; }
        .header-info {
            background: #e3f2fd;
            padding: 20px;
            border-radius: 6px;
            border-left: 4px solid #2196f3;
            margin-bottom: 30px;
        }
        .form-section {
            margin-bottom: 30px;
            padding: 20px;
            border: 1px solid #e0e0e0;
            border-radius: 6px;
            background: #fafafa;
        }
        .form-section h3 {
            margin-top: 0;
            color: #34495e;
            border-bottom: 2px solid #3498db;
            padding-bottom: 10px;
        }
        .form-group {
            margin-bottom: 20px;
        }
        label {
            display: block;
            margin-bottom: 8px;
            font-weight: bold;
            color: #555;
        }
        input, select, textarea {
            width: 100%;
            padding: 10px;
            border: 1px solid #ddd;
            border-radius: 4px;
            font-size: 14px;
            box-sizing: border-box;
        }
        
        .base-system-preview {
            background: #f8f9fa;
            border: 1px solid #e0e0e0;
            border-radius: 6px;
            padding: 20px;
            margin-top: 20px;
        }
        .entity-summary {
            display: grid;
            grid-template-columns: repeat(auto-fit, minmax(200px, 1fr));
            gap: 15px;
            margin-top: 15px;
        }
        .entity-group {
            background: white;
            border: 1px solid #ddd;
            border-radius: 4px;
            padding: 12px;
        }
        .entity-group h5 {
            margin: 0 0 10px 0;
            color: #666;
            font-size: 12px;
            text-transform: uppercase;
        }
        .entity-list {
            font-size: 11px;
            line-height: 1.4;
        }
        
        .view-definitions {
            background: #fff3cd;
            border: 1px solid #ffeaa7;
            border-radius: 6px;
            padding: 15px;
            margin-top: 15px;
        }
        .view-grid {
            display: grid;
            grid-template-columns: 1fr 1fr;
            gap: 20px;
            margin-top: 15px;
        }
        .view-box {
            background: white;
            border: 1px solid #ddd;
            border-radius: 4px;
            padding: 15px;
        }
        .view-box h4 {
            margin: 0 0 10px 0;
            color: #333;
        }
        
        .customization-section {
            border-left: 4px solid #f39c12;
            background: #fefefe;
        }
        
        .submit-button {
            background: #27ae60;
            color: white;
            border: none;
            padding: 15px 30px;
            border-radius: 4px;
            font-size: 16px;
            cursor: pointer;
            width: 100%;
        }
        .submit-button:hover {
            background: #219a52;
        }
        .progress-indicator {
            display: none;
            background: #3498db;
            color: white;
            padding: 10px;
            border-radius: 4px;
            margin-bottom: 20px;
        }
    </style>
</head>
<body>
    <div class="container">
        <h1>üèóÔ∏è Stage 1: Base System Configuration</h1>
        
        <div class="header-info">
            <h4>üéØ Using Predefined Universal Service Model</h4>
            <p><strong>Base System:</strong> Accounts Module with 17 core entities covering Customer Management, Service Locations, and Work Orders</p>
            <p><strong>Focus:</strong> Domain customization and business rule configuration (not entity selection)</p>
        </div>
        
        <div class="progress-indicator" id="progress">
            Processing base system configuration...
        </div>

        <form id="baseSystemForm">
            <!-- Service Domain Configuration -->
            <div class="form-section">
                <h3>Service Domain Configuration</h3>
                
                <div class="form-group">
                    <label for="serviceDomain">Service Domain</label>
                    <select id="serviceDomain" name="serviceDomain" required>
                        <option value="">Select service domain...</option>
                        <option value="pestControl">Pest Control</option>
                        <option value="hvac">HVAC</option>
                        <option value="pools">Pool Service</option>
                        <option value="landscaping">Landscaping</option>
                        <option value="cleaning">Cleaning Services</option>
                    </select>
                </div>

                <div class="form-group">
                    <label for="clientName">Client Company Name</label>
                    <input type="text" id="clientName" name="clientName" placeholder="ABC Service Company" required>
                </div>

                <div class="form-group">
                    <label for="deploymentTarget">Deployment Target</label>
                    <select id="deploymentTarget" name="deploymentTarget" required>
                        <option value="">Select deployment...</option>
                        <option value="prototype">Prototype (Development)</option>
                        <option value="pilot">Pilot (Limited Production)</option>
                        <option value="production">Full Production</option>
                    </select>
                </div>
            </div>

            <!-- Base System Preview -->
            <div class="form-section">
                <h3>Universal Base System (All Domains)</h3>
                
                <div class="base-system-preview">
                    <h4>üìã Core Entity Model (17 Entities)</h4>
                    <div class="entity-summary" id="entitySummary">
                        <div class="entity-group">
                            <h5>Core Entities (3)</h5>
                            <div class="entity-list">
                                ACCOUNT (8 fields)<br>
                                SERVICE_LOCATION (14 fields)<br>
                                WORK_ORDER (12 fields)
                            </div>
                        </div>
                        <div class="entity-group">
                            <h5>Supporting (7)</h5>
                            <div class="entity-list">
                                CONTACT, SERVICEABLE_ITEM<br>
                                SERVICE_AGREEMENT, INVOICE<br>
                                PAYMENT, COMMUNICATION_LOG<br>
                                + 1 more
                            </div>
                        </div>
                        <div class="entity-group">
                            <h5>Junction (5)</h5>
                            <div class="entity-list">
                                CONTACT_LOCATION<br>
                                AGREEMENT_ITEM<br>
                                WORK_ORDER_ITEM<br>
                                + 2 more
                            </div>
                        </div>
                        <div class="entity-group">
                            <h5>Lookup (3)</h5>
                            <div class="entity-list">
                                DOMAIN<br>
                                GEOGRAPHIC_AREA<br>
                                SERVICE_ZONE
                            </div>
                        </div>
                    </div>
                </div>

                <div class="view-definitions">
                    <h4>üñ•Ô∏è Standard View Definitions</h4>
                    <div class="view-grid">
                        <div class="view-box">
                            <h4>Master View</h4>
                            <p><strong>Layout:</strong> 3-column</p>
                            <ul>
                                <li><strong>Left:</strong> Account Hub</li>
                                <li><strong>Center:</strong> Service Locations</li>
                                <li><strong>Right:</strong> Work Orders</li>
                            </ul>
                        </div>
                        <div class="view-box">
                            <h4>Analysis View</h4>
                            <p><strong>Layout:</strong> Spreadsheet-like</p>
                            <ul>
                                <li>Accounts List (sortable/filterable)</li>
                                <li>Locations List with analytics</li>
                                <li>Work Orders tracking</li>
                                <li>Revenue analysis</li>
                            </ul>
                        </div>
                    </div>
                </div>
            </div>

            <!-- Domain Customizations -->
            <div class="form-section customization-section">
                <h3>Domain-Specific Customizations</h3>
                
                <div id="domainCustomizations">
                    <p><em>Select a service domain above to see available customizations...</em></p>
                </div>

                <div class="form-group">
                    <label for="additionalCustomizations">Additional Custom Requirements</label>
                    <textarea id="additionalCustomizations" name="additionalCustomizations" rows="4" 
                        placeholder="Describe any custom fields, business rules, or integrations needed for your specific business..."></textarea>
                </div>
            </div>

            <!-- Business Rules Configuration -->
            <div class="form-section">
                <h3>Business Rules Configuration</h3>
                
                <div class="form-group">
                    <label>Universal Business Rules (Applied to All Domains)</label>
                    <div class="base-system-preview">
                        <ul>
                            <li><strong>Account:</strong> Must have at least one contact, status determines service availability</li>
                            <li><strong>Service Location:</strong> Must belong to account, requires complete address</li>
                            <li><strong>Work Order:</strong> Requires account and location, status controls permissions</li>
                        </ul>
                    </div>
                </div>

                <div class="form-group">
                    <label for="customBusinessRules">Domain-Specific Business Rules</label>
                    <textarea id="customBusinessRules" name="customBusinessRules" rows="3" 
                        placeholder="Additional business rules specific to your service domain..."></textarea>
                </div>
            </div>

            <!-- Template Options -->
            <div class="form-section">
                <h3>Template Configuration</h3>
                
                <div class="form-group">
                    <input type="checkbox" id="saveAsTemplate" name="saveAsTemplate" checked>
                    <label for="saveAsTemplate" style="display: inline; margin-left: 10px;">Save as reusable domain template</label>
                </div>

                <div class="form-group">
                    <label for="templateName">Template Name</label>
                    <input type="text" id="templateName" name="templateName" readonly>
                </div>
            </div>

            <!-- Submit -->
            <button type="submit" class="submit-button">
                üöÄ Generate Base System Configuration
            </button>
        </form>
    </div>

    <script>
        // Domain-specific customizations
        const domainCustomizations = {
            pestControl: {
                name: "Pest Control Services",
                additionalFields: {
                    ACCOUNT: ["Treatment Frequency", "Chemical Restrictions"],
                    SERVICE_LOCATION: ["Property Size", "Treatment Areas"], 
                    SERVICEABLE_ITEM: ["Infestation Type", "Treatment History"]
                },
                businessRules: [
                    "Chemical restrictions must be verified before treatment",
                    "Treatment frequency determines scheduling intervals"
                ]
            },
            hvac: {
                name: "HVAC Services",
                additionalFields: {
                    SERVICEABLE_ITEM: ["System Type", "BTU Capacity", "Filter Type", "Last Maintenance Date"]
                },
                businessRules: [
                    "Seasonal maintenance schedules based on system type",
                    "Filter replacement tracking required"
                ]
            },
            pools: {
                name: "Pool Services", 
                additionalFields: {
                    SERVICEABLE_ITEM: ["Pool Type", "Volume", "Filter System", "Chemical Balance"]
                },
                businessRules: [
                    "Chemical balance testing required at each service",
                    "Seasonal opening/closing procedures"
                ]
            },
            landscaping: {
                name: "Landscaping Services",
                additionalFields: {
                    SERVICE_LOCATION: ["Property Acreage", "Irrigation System", "Seasonal Schedule"],
                    SERVICEABLE_ITEM: ["Plant Type", "Planting Date", "Care Instructions"]
                },
                businessRules: [
                    "Seasonal service schedules vary by plant types",
                    "Weather conditions affect service timing"
                ]
            },
            cleaning: {
                name: "Cleaning Services",
                additionalFields: {
                    SERVICE_LOCATION: ["Square Footage", "Room Count", "Special Requirements"],
                    SERVICE_AGREEMENT: ["Cleaning Frequency", "Supply Requirements"]
                },
                businessRules: [
                    "Supply inventory tracked per location",
                    "Frequency determines pricing tiers"
                ]
            }
        };

        // Handle service domain selection
        document.getElementById('serviceDomain').addEventListener('change', function() {
            const domain = this.value;
            const customizationsDiv = document.getElementById('domainCustomizations');
            const templateName = document.getElementById('templateName');
            
            if (domain && domainCustomizations[domain]) {
                const config = domainCustomizations[domain];
                
                customizationsDiv.innerHTML = `
                    <h4>${config.name} Customizations</h4>
                    <div class="base-system-preview">
                        <h5>Additional Fields:</h5>
                        <ul>
                            ${Object.entries(config.additionalFields).map(([entity, fields]) => 
                                `<li><strong>${entity}:</strong> ${fields.join(', ')}</li>`
                            ).join('')}
                        </ul>
                        
                        <h5>Domain Business Rules:</h5>
                        <ul>
                            ${config.businessRules.map(rule => `<li>${rule}</li>`).join('')}
                        </ul>
                    </div>
                `;
                
                // Update template name
                const clientName = document.getElementById('clientName').value || 'Client';
                const date = new Date().toISOString().split('T')[0].replace(/-/g, '');
                templateName.value = `${config.name.replace(/\s+/g, '')}_${clientName.replace(/\s+/g, '')}_${date}`;
                
            } else {
                customizationsDiv.innerHTML = '<p><em>Select a service domain above to see available customizations...</em></p>';
                templateName.value = '';
            }
        });

        // Update template name when client name changes
        document.getElementById('clientName').addEventListener('input', function() {
            const domain = document.getElementById('serviceDomain').value;
            if (domain && domainCustomizations[domain]) {
                const config = domainCustomizations[domain];
                const date = new Date().toISOString().split('T')[0].replace(/-/g, '');
                document.getElementById('templateName').value = `${config.name.replace(/\s+/g, '')}_${this.value.replace(/\s+/g, '')}_${date}`;
            }
        });

        // Handle form submission
        document.getElementById('baseSystemForm').addEventListener('submit', function(e) {
            e.preventDefault();
            
            const progress = document.getElementById('progress');
            progress.style.display = 'block';
            progress.textContent = 'Generating base system configuration...';
            progress.style.background = '#3498db';

            // Collect form data
            const formData = new FormData(this);
            const config = {
                serviceDomain: formData.get('serviceDomain'),
                clientName: formData.get('clientName'),
                deploymentTarget: formData.get('deploymentTarget'),
                additionalCustomizations: formData.get('additionalCustomizations'),
                customBusinessRules: formData.get('customBusinessRules'),
                saveAsTemplate: formData.get('saveAsTemplate') === 'on',
                templateName: formData.get('templateName'),
                baseSystem: {
                    totalEntities: 17,
                    coreEntities: ['ACCOUNT', 'SERVICE_LOCATION', 'WORK_ORDER'],
                    views: ['Master View', 'Analysis View'],
                    domainCustomizations: domainCustomizations[formData.get('serviceDomain')] || null
                }
            };

            // Simulate base system generation
            setTimeout(() => {
                progress.textContent = 'Base System Configuration Generated Successfully!';
                progress.style.background = '#27ae60';
                
                console.log('Base System Configuration:', config);
                
                alert(`üéâ Base System Generated!\n\nDomain: ${config.baseSystem.domainCustomizations?.name || config.serviceDomain}\nClient: ${config.clientName}\nEntities: ${config.baseSystem.totalEntities} (universal base)\nViews: ${config.baseSystem.views.join(', ')}\nTemplate: ${config.saveAsTemplate ? 'Saved as ' + config.templateName : 'Not saved'}\n\nüöÄ Ready for Factory Processing!\n\nNext: Run through Concept Line ‚Üí Prototype Line ‚Üí Production Line`);
            }, 2000);
        });
    </script>
</body>
</html>